<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>osu! User Lookup</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2d3748;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <div class="bg-gray-800 p-8 rounded-xl shadow-2xl w-full max-w-2xl border border-gray-700">
        <h1 class="text-4xl font-bold text-center mb-8 text-blue-400">osu! User Lookup</h1>

        <div class="mb-6">
            <label for="usernameInput" class="block text-gray-300 text-sm font-semibold mb-2">
                osu! Username:
            </label>
            <input
                type="text"
                id="usernameInput"
                class="shadow-sm appearance-none border border-gray-600 rounded-lg w-full py-3 px-4 text-gray-200 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-700 transition duration-300 ease-in-out"
                placeholder="Enter osu! username (e.g., peppy)"
            >
        </div>

        <button
            id="searchButton"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-300 ease-in-out transform hover:scale-105 shadow-lg"
        >
            Search User
        </button>

        <div id="loadingIndicator" class="hidden text-center mt-6 text-blue-300 font-medium">
            Loading user data...
        </div>

        <div id="errorMessage" class="hidden bg-red-800 text-red-100 p-4 rounded-lg mt-6 border border-red-700">
            <!-- Error messages will be displayed here -->
        </div>

        <div id="userInfo" class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-200">
            <!-- User information will be displayed here -->
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // IMPORTANT: Replace "YOUR_OSU_API_KEY_HERE" with your actual osu! API Key (v1)
            // You can get your v1 API key from your osu! account settings.
            const OSU_API_KEY = "YOUR_OSU_API_KEY_HERE";

            const usernameInput = document.getElementById('usernameInput');
            const searchButton = document.getElementById('searchButton');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const errorMessage = document.getElementById('errorMessage');
            const userInfoDiv = document.getElementById('userInfo');

            // Function to display error messages
            function displayError(message) {
                errorMessage.textContent = message;
                errorMessage.classList.remove('hidden');
                userInfoDiv.innerHTML = ''; // Clear previous user info
            }

            // Function to clear error messages
            function clearError() {
                errorMessage.classList.add('hidden');
                errorMessage.textContent = '';
            }

            // Function to show loading indicator
            function showLoading() {
                loadingIndicator.classList.remove('hidden');
                searchButton.disabled = true; // Disable button during loading
                searchButton.classList.add('opacity-50', 'cursor-not-allowed');
                clearError();
                userInfoDiv.innerHTML = ''; // Clear previous user info
            }

            // Function to hide loading indicator
            function hideLoading() {
                loadingIndicator.classList.add('hidden');
                searchButton.disabled = false; // Enable button after loading
                searchButton.classList.remove('opacity-50', 'cursor-not-allowed');
            }

            // Function to fetch user data from osu! API
            async function fetchUserData() {
                const username = usernameInput.value.trim();

                if (OSU_API_KEY === "YOUR_OSU_API_KEY_HERE" || !OSU_API_KEY) {
                    displayError('Please replace "YOUR_OSU_API_KEY_HERE" with your actual osu! API Key in the code.');
                    return;
                }
                if (!username) {
                    displayError('Please enter an osu! username.');
                    return;
                }

                showLoading();

                const apiUrl = `https://osu.ppy.sh/api/get_user?k=${OSU_API_KEY}&u=${username}&type=string`;

                try {
                    const response = await fetch(apiUrl);
                    const data = await response.json();

                    if (!response.ok) {
                        // Handle HTTP errors (e.g., 401 Unauthorized, 404 Not Found)
                        if (response.status === 401) {
                            displayError('Invalid API Key. Please ensure your osu! API Key is correct and active.');
                        } else if (response.status === 404) {
                            displayError('API endpoint not found. This might be an issue with the osu! API service.');
                        } else {
                            displayError(`API Error: ${response.status} ${response.statusText}`);
                        }
                        return;
                    }

                    if (data.length === 0) {
                        displayError(`User "${username}" not found. Please check the username.`);
                        return;
                    }

                    const user = data[0]; // The API returns an array, even for a single user

                    // Display user information
                    userInfoDiv.innerHTML = `
                        <div class="bg-gray-700 p-4 rounded-lg shadow-md border border-gray-600">
                            <h2 class="text-2xl font-bold text-blue-300 mb-2">${user.username}</h2>
                            <p class="text-sm text-gray-400">User ID: <span class="font-semibold">${user.user_id}</span></p>
                        </div>
                        <div class="bg-gray-700 p-4 rounded-lg shadow-md border border-gray-600">
                            <p><strong>Rank:</strong> #${user.pp_rank} (${user.country}#${user.pp_country_rank})</p>
                            <p><strong>Performance Points (PP):</strong> ${parseFloat(user.pp_raw).toFixed(2)}</p>
                            <p><strong>Accuracy:</strong> ${parseFloat(user.accuracy).toFixed(2)}%</p>
                        </div>
                        <div class="bg-gray-700 p-4 rounded-lg shadow-md border border-gray-600">
                            <p><strong>Playcount:</strong> ${user.playcount}</p>
                            <p><strong>Level:</strong> ${parseFloat(user.level).toFixed(2)}</p>
                            <p><strong>Total Score:</strong> ${user.total_score}</p>
                        </div>
                        <div class="bg-gray-700 p-4 rounded-lg shadow-md border border-gray-600">
                            <p><strong>Ranked Score:</strong> ${user.ranked_score}</p>
                            <p><strong>SS Count:</strong> ${user.count_rank_ss}</p>
                            <p><strong>S Count:</strong> ${user.count_rank_s}</p>
                            <p><strong>A Count:</strong> ${user.count_rank_a}</p>
                        </div>
                        <div class="bg-gray-700 p-4 rounded-lg shadow-md border border-gray-600 col-span-1 md:col-span-2">
                            <p><strong>Join Date:</strong> ${user.join_date}</p>
                            <p><strong>Country:</strong> ${user.country}</p>
                            <p><strong>Total Hits:</strong> ${parseInt(user.count300) + parseInt(user.count100) + parseInt(user.count50)}</p>
                        </div>
                    `;
                } catch (error) {
                    console.error('Error fetching user data:', error);
                    displayError('Failed to fetch user data. Please check your internet connection or try again later.');
                } finally {
                    hideLoading();
                }
            }

            // Event listener for the search button
            searchButton.addEventListener('click', fetchUserData);

            // Optional: Allow searching by pressing Enter in the username input
            usernameInput.addEventListener('keypress', (event) => {
                if (event.key === 'Enter') {
                    fetchUserData();
                }
            });
        });
    </script>
</body>
</html>
